<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basket</title>
    <link href="https://fonts.googleapis.com/css?family=Raleway|Roboto" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="./style.css">
</head>
<body>
  <header class="header">
    <div class="item__container logo__container"><a class="logo__text nav__link" href="index.html"><img class="logo" src="./assets/images/logo.svg" width="25" alt=""><b>Vtubelab</b></a></div>
    <div class="item__container catalog"><a class="nav__link" href="catalog.html"><b>Catalog</b></a></div>
    <div class="item__container gallery"><a class="nav__link" href="gallery.html"><b>Gallery</b></a></div>
    <div class="item__container basket"><a class="nav__link" href="basket.html"><img class="basket__logo" src="assets/images/basket.svg" alt=""></a></div>
  </header>
  <div class="cart-container animate__animated">
    <h2 class="cart-title">Cart</h2>
    <div class="amount-title">
      <div class="cart-product"><strong>Продукт</strong></div>
      <div class="cart-quantity"><strong>Кол-во</strong></div>
      <div class="cart-price"><strong>Цена</strong></div>
    </div>
    <div id="carttable"></div>
    <div id="carttotals">
      <div class="total-container">
        <div class="total-title"><h2>Итого:</h2></div>
        <div class="total-quantity">
          <span id="itemsquantity"></span>
        </div>
        <div class="total-price">
          <span id="total">0₽</span>
        </div>
        <div class="cart-buttons">  
          <button class="cart-delete" id="emptycart" onclick="emptyCart()"><img src="./assets/images/trash.svg" alt=""></button>
          <button class="cart-buy"id="buy-button" onclick="showPaymentPopup()">Оплатить</button>
        </div>
      </div>
    </div>
    <h2>История покупок</h2>
    <div class="purchase-history" id="purchase-history"></div>
  </div>


  <!-- Оплата -->
  <div id="payment-popup" class="popup animate__animated animate__fadeIn">
    <div class="popup-content">
        <span class="close-button" onclick="closePaymentPopup()">&times;</span>
        <h2>Оплата</h2>
        <p>Выберите ваш способ оплаты:</p>
        <div class="payment-way">
          <div class="payment-way__button"><button onclick="payWith('Credit Card')">
            <img class="payment-way__image" src="./assets/images/visa.svg" alt=""><br>Visa</button></div>
          <div class="payment-way__button"><button onclick="payWith('PayPal')"><img class="payment-way__image" src="./assets/images/paypal.svg" alt=""><br>PayPal</button></div>
          <div class="payment-way__button"><button onclick="payWith('Bank Transfer')"><img class="payment-way__image" src="./assets/images/sbp.svg" alt=""><br>Система быстрых платежей</button></div>
        </div>
    </div>
</div>


    <!-- Подтверждение покупки -->
    <div id="confirmation-popup" class="popup animate__animated animate__fadeIn">
      <div class="popup-content">
          <span class="close-button" onclick="closeConfirmationPopup()">&times;</span>
          <h2>Спасибо за покупку!</h2>
          <div class="confirmation-text">
            <p>Ваш код подтверждения: <b><span id="confirmation-code"></b></span></p>
            <button class="button-copy" onclick="copyCode()"><img src="./assets/images/copy.svg" alt=""></button>
          </div>
          <p class="confirmation-subtext">Теперь свяжитесь с нами в сообществе<a class="confirmation-link" href="#"><b>Discord</b></a>для дальнейшего уточнения вашего заказа.</p>
      </div>
  </div>
  
  <script src="./assets/scripts/basket.js"></script>
  <script>
    function animateAndNavigate(event, url, animation) {
        event.preventDefault(); // Prevent the default link behavior

        const elements = document.querySelectorAll('.animate__animated:not(.header)');
        let delay = 0;

        elements.forEach((element) => {
            setTimeout(() => {
                element.classList.remove('animate__fadeInDown');
                element.classList.add(animation);
                element.style.opacity = 1;
            }, delay);
            delay += 100;
        });

        setTimeout(() => {
            window.location.href = url;
        }, delay + 500);
    }

    document.addEventListener("DOMContentLoaded", () => {
        const elements = document.querySelectorAll('.animate__animated');
        let delay = 0;

        elements.forEach((element) => {
            if (element.classList.contains('header')) {
                element.classList.add('animate__fadeInUp');
                element.style.opacity = 1;
            } else {
                setTimeout(() => {
                    element.classList.add('animate__fadeInUp');
                    element.style.opacity = 1;
                }, delay);
                delay += 500;
            }
        });

        // Add event listeners to the links
        document.querySelector('a[href="index.html"]').addEventListener('click', function(event) {
            animateAndNavigate(event, 'index.html', 'animate__fadeOutDown');
        });

        document.querySelector('a[href="catalog.html"]').addEventListener('click', function(event) {
            animateAndNavigate(event, 'catalog.html', 'animate__fadeOutDown');
        });

        document.querySelector('a[href="gallery.html"]').addEventListener('click', function(event) {
            animateAndNavigate(event, 'gallery.html', 'animate__fadeOutDown');
        });
    });
</script>
</body>
</html>
